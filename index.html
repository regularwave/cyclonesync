<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">

    <link rel="apple-touch-icon" href="img/CycloneSync-iOS-180.png">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-title" content="CycloneSync">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#000000">

    <link href="https://cdn.jsdelivr.net/npm/@regularwave/beleren-bold-woff2@latest/css/beleren-bold-w2.css" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/keyrune@latest/css/keyrune.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mana-font@latest/css/mana.css">
    <link rel="stylesheet" href="style.css">

    <link rel="manifest" href="manifest.json">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js" defer></script>
    <script src="https://unpkg.com/html5-qrcode" type="text/javascript" defer></script>

    <link rel="shortcut icon" type="image/svg" href="img/CycloneSync.svg">

    <title>CycloneSync</title>
    <meta name="description" content="Synchronize life totals with your pod! No ads, no sign-ups, no having to touch another person's phone!">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://regularwave.github.io/cyclonesync/">
    <meta property="og:title" content="CycloneSync">
    <meta property="og:description" content="Synchronize life totals with your pod! No ads, no sign-ups, no having to touch another person's phone!">
    <meta property="og:image" content="https://regularwave.github.io/cyclonesync/img/og-preview.png">
</head>

<body>
    <div id="container" class="floatcontainer">
        <main id="content" class="content">
            <div id="top-row" class="top-row">
                <div class="tile-wrapper" id="tile-life">
                    <div class="manasymbol-container">
                        <i class="ms ss-foil ss-grad ms-ability-lifelink toprow-manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="life" min="0" max="999" value="40" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'life', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'life', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-tax">
                    <div class="manasymbol-container">
                        <i class="ss ss-foil ss-grad ss-cmd toprow-manasymbol-icon"></i>
                    </div>
                    <div class="tax-half" id="tax-half-1">
                        <input class="quantity" id="tax" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                        <div class="spinner-btns">
                            <button class="plus" onpointerdown="startHold(event, 'tax', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                            <button class="minus" onpointerdown="startHold(event, 'tax', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                        </div>
                    </div>
                    <div class="tax-half hidden" id="tax-half-2">
                        <input class="quantity" id="tax2" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                        <div class="spinner-btns">
                            <button class="plus" onpointerdown="startHold(event, 'tax2', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                            <button class="minus" onpointerdown="startHold(event, 'tax2', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                        </div>
                    </div>
                </div>
            </div>
            <div id="room-row" class="room-row hidden">
                <div class="room-qr-trigger" onclick="showRoomQR()">
                    <i class="ms ms-counter-brick"></i>
                    <span>QR</span>
                </div>
                <div id="remote-players-container" class="remote-players-grid">
                </div>
                <div class="room-exit-btn" onclick="leaveRoom()">
                    <i class="ss ss-foil ss-grad ss-bfz ss-2x"></i>
                </div>
            </div>
            <div class="tracker-grid">
                <div class="tile-wrapper hidden" id="tile-w">
                    <div class="manasymbol-container">
                        <i class="ms ms-w ms-fw manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-w" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-w', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-w', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-u">
                    <div class="manasymbol-container">
                        <i class="ms ms-u manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-u" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-u', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-u', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-b">
                    <div class="manasymbol-container">
                        <i class="ms ms-b manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-b" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-b', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-b', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-r">
                    <div class="manasymbol-container">
                        <i class="ms ms-r ms-fw manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-r" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-r', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-r', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-g">
                    <div class="manasymbol-container">
                        <i class="ms ms-g manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-g" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-g', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-g', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="tile-wrapper hidden" id="tile-c">
                    <div class="manasymbol-container">
                        <i class="ms ms-c manasymbol-icon"></i>
                    </div>
                    <input class="quantity" id="mana-c" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'mana-c', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'mana-c', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
            </div>
            <div id="counters-row" class="counters-grid hidden">
                <div class="counter-tile" id="tile-c1">
                    <i id="icon-c1" class="ms ms-h ms-2x counter-icon"></i>
                    <div id="label-c1" class="counter-name">Poison</div>
                    <input class="quantity counter-qty" id="cnt-c1" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c1', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c1', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="counter-tile" id="tile-c2">
                    <i id="icon-c2" class="ss ss-c15 ss-2x counter-icon"></i>
                    <div id="label-c2" class="counter-name">Experience</div>
                    <input class="quantity counter-qty" id="cnt-c2" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c2', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c2', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="counter-tile" id="tile-c3">
                    <i id="icon-c3" class="ms ms-energy ms-2x counter-icon"></i>
                    <div id="label-c3" class="counter-name">Energy</div>
                    <input class="quantity counter-qty" id="cnt-c3" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c3', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c3', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="counter-tile" id="tile-c4">
                    <i id="icon-c4" class="ms ms-counter-rad ms-2x counter-icon"></i>
                    <div id="label-c4" class="counter-name">Rads</div>
                    <input class="quantity counter-qty" id="cnt-c4" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c4', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c4', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="counter-tile hidden" id="tile-c5">
                    <i id="icon-c5" class="ms ms-star ms-2x counter-icon"></i>
                    <div id="label-c5" class="counter-name">Custom 1</div>
                    <input class="quantity counter-qty" id="cnt-c5" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c5', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c5', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
                <div class="counter-tile hidden" id="tile-c6">
                    <i id="icon-c6" class="ms ms-star ms-2x counter-icon"></i>
                    <div id="label-c6" class="counter-name">Custom 2</div>
                    <input class="quantity counter-qty" id="cnt-c6" min="0" max="999" value="0" type="number" readonly tabindex="-1">
                    <div class="spinner-btns">
                        <button class="plus" onpointerdown="startHold(event, 'cnt-c6', 1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                        <button class="minus" onpointerdown="startHold(event, 'cnt-c6', -1)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                    </div>
                </div>
            </div>
            <div class="floating-controls">
                <div id="dock-container" class="dock-container">
                    <button class="control-btn" id="btn-life" onclick="toggleLife();">
                        <i class="ms ss-foil ss-grad ms-ability-lifelink"></i>
                    </button>
                    <button class="control-btn" id="btn-pips" oncontextmenu="return false;">
                        <i class="ms ss-foil ss-grad ms-watermark-colorpie"></i>
                    </button>
                    <button class="control-btn" id="btn-cmd" onclick="toggleCmdModal()">
                        <i class="ss ss-foil ss-grad ss-mic"></i>
                    </button>
                    <button class="control-btn" id="btn-connect" onclick="toggleConnectModal()">
                        <i class="ss ss-foil ss-grad ss-eoe"></i>
                    </button>
                    <button class="control-btn disabled" id="btn-counters" oncontextmenu="return false;">
                        <i class="ss ss-foil ss-grad ss-nph"></i>
                    </button>
                </div>
                <button class="control-btn btn-danger" id="btn-reset" onclick="openResetModal()">
                    <i class="ms ss-foil ss-grad ms-ability-dfc"></i>
                </button>
                <div class="flyout-wrapper" id="flyout-wrapper">
                    <button class="control-btn" id="btn-settings" onpointerdown="startDockHold(event)" onpointerup="stopDockHold()" onpointercancel="cancelDockHold()" oncontextmenu="return false;">
                        <i class="ss ss-foil ss-grad ss-usg"></i>
                    </button>
                    <div class="flyout-bubble hidden" id="flyout-bubble">
                        <button class="control-btn disabled hidden" id="flyout-empty-msg" style="width: 100%; font-size: 0.9rem; font-family: var(--font-ui);" disabled>
                            ALL DOCKED
                        </button>
                        <button class="control-btn disabled" id="btn-tax" oncontextmenu="return false;">
                            <i class="ss ss-foil ss-grad ss-cmd"></i>
                        </button>
                        <button class="control-btn" id="btn-udlrswap" onclick="toggleUDLR();">
                            <div id="icon-udlrswap" class="udlr-wrapper">
                                <i class="ms ss-foil ss-grad ms-dfc-front"></i>
                                <span class="udlr-plus ss-foil ss-grad">&plus;</span>
                            </div>
                        </button>
                        <button class="control-btn" id="btn-awake" onclick="toggleWakeLock();">
                            <i class="ms ss-foil ss-grad ms-dfc-day"></i>
                        </button>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <div id="credits-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content modal-content-fit">
            <h2>Credits & Legal</h2>
            <p>Background image:
                <br>
                <i class="ms ss-foil ss-grad ms-artist-nib"></i> <em>black and white clouds in the sky</em> illustration
                by Mikhail Tyrsyna
            </p>
            <p>Fonts:
                <br>
                <a href="https://github.com/andrewgioia/keyrune" target="_blank">Keyrune</a> and <a href="https://github.com/andrewgioia/Mana" target="_blank">Mana</a> fonts by <a href="https://andrewgioia.com/">Andrew Gioia</a> (SIL OFL 1.1)
                <br>
                Beleren font from Wizards of the Coast
            </p>
            <p class="legal-text">
                CycloneSync is unofficial Fan Content permitted under the Fan Content Policy. Not approved/endorsed by
                Wizards of the Coast. Portions of the materials used are property of Wizards of the Coast; those
                portions &copy; Wizards of the Coast LLC.
            </p>
            <button class="close-btn" onclick="toggleCredits()">CLOSE</button>
        </div>
    </div>
    <div id="pips-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content">
            <h2>Mana Tile Visibility</h2>
            <p class="help-subtext">Select tiles to always show. Unselected toggle via the &ensp;<i class="ms ss-foil ss-grad ms-watermark-colorpie"></i>&ensp; button.</p>
            <div class="pips-grid">
                <input type="checkbox" id="chk-white" class="pip-chk" value="white">
                <label for="chk-white" class="pip-label"><i class="ms ms-w ms-cost ms-2x"></i></label>
                <input type="checkbox" id="chk-blue" class="pip-chk" value="blue">
                <label for="chk-blue" class="pip-label"><i class="ms ms-u ms-cost ms-2x"></i></label>
                <input type="checkbox" id="chk-black" class="pip-chk" value="black">
                <label for="chk-black" class="pip-label"><i class="ms ms-b ms-cost ms-2x"></i></label>
                <input type="checkbox" id="chk-red" class="pip-chk" value="red">
                <label for="chk-red" class="pip-label"><i class="ms ms-r ms-cost ms-2x"></i></label>
                <input type="checkbox" id="chk-green" class="pip-chk" value="green">
                <label for="chk-green" class="pip-label"><i class="ms ms-g ms-cost ms-2x"></i></label>
                <input type="checkbox" id="chk-colorless" class="pip-chk" value="colorless">
                <label for="chk-colorless" class="pip-label"><i class="ms ms-c ms-cost ms-2x"></i></label>
            </div>
            <button class="close-btn btn-primary" onclick="savePipsConfig()">SAVE & CLOSE</button>
        </div>
    </div>
    <div id="cmd-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content">
            <div class="cmd-modal-header">
                <h2>Commander Damage</h2>
                <div class="cmd-life-display">
                    <i class="ms ss-foil ss-grad ms-ability-lifelink"></i>
                    <span id="cmd-modal-life">40</span>
                </div>
            </div>
            <div class="cmd-quarters">
                <div class="cmd-quarter">
                    <div class="player-name-wrapper">
                        <i id="sync-icon-p1" class="ss ss-foil ss-grad ss-eoe hidden"></i>
                        <input type="text" id="name-p1" class="player-name" value="Player 1" placeholder="Name" maxlength="12" oninput="savePlayerName(this)">
                    </div>
                    <div class="cmd-counters-vertical">
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p1-c1" value="Commander 1" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p1-c1" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p1-c1', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p1-c1', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p1-c2" value="Commander 2" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p1-c2" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p1-c2', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p1-c2', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cmd-quarter">
                    <div class="player-name-wrapper">
                        <i id="sync-icon-p2" class="ss ss-foil ss-grad ss-eoe hidden"></i>
                        <input type="text" id="name-p2" class="player-name" value="Player 2" placeholder="Name" maxlength="12" oninput="savePlayerName(this)">
                    </div>
                    <div class="cmd-counters-vertical">
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p2-c1" value="Commander 1" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p2-c1" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p2-c1', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p2-c1', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p2-c2" value="Commander 2" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p2-c2" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p2-c2', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p2-c2', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cmd-quarter">
                    <div class="player-name-wrapper">
                        <i id="sync-icon-p3" class="ss ss-foil ss-grad ss-eoe hidden"></i>
                        <input type="text" id="name-p3" class="player-name" value="Player 3" placeholder="Name" maxlength="12" oninput="savePlayerName(this)">
                    </div>
                    <div class="cmd-counters-vertical">
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p3-c1" value="Commander 1" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p3-c1" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p3-c1', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p3-c1', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p3-c2" value="Commander 2" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p3-c2" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p3-c2', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p3-c2', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="cmd-quarter">
                    <div class="player-name-wrapper">
                        <i id="sync-icon-p4" class="ss ss-foil ss-grad ss-eoe hidden"></i>
                        <input type="text" id="name-p4" class="player-name" value="Player 4" placeholder="Name" maxlength="12" oninput="savePlayerName(this)">
                    </div>
                    <div class="cmd-counters-vertical">
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p4-c1" value="Commander 1" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p4-c1" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p4-c1', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p4-c1', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                        <div class="cmd-wrapper">
                            <input type="text" class="cmd-name-input" id="name-cmd-p4-c2" value="Commander 2" maxlength="24" oninput="saveCmdName(this)">
                            <div class="cmd-counter-unit">
                                <input class="quantity cmd-qty" id="cmd-p4-c2" value="0" type="number" readonly tabindex="-1">
                                <div class="spinner-btns">
                                    <button class="plus" onpointerdown="startHold(event, 'cmd-p4-c2', 1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&plus;</button>
                                    <button class="minus" onpointerdown="startHold(event, 'cmd-p4-c2', -1, true)" onpointerup="stopHold()" onpointerleave="stopHold()" onpointercancel="stopHold()" oncontextmenu="return false;">&minus;</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <button class="close-btn" onclick="toggleCmdModal()">CLOSE</button>
        </div>
    </div>
    <div id="connect-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content modal-content-fit">
            <h2>CycloneSync PodConnect</h2>
            <div id="connect-step-1">
                <div id="ios-pwa-warning" class="ios-warning-box hidden">
                    <span class="ios-warning-text">
                        <i class="ms ms-dfc-day"></i> <strong>iOS User?</strong> If you have the CycloneSync app
                        installed, open it from your Home Screen to keep your saved settings!
                    </span>
                    <div id="ios-room-code-section" class="ios-code-section hidden">
                        Tap to copy room code: <br>
                        <strong id="ios-room-code-display" class="copyable-code ios-code-display" onclick="copyPendingRoomCode()" title="Tap to copy"></strong>
                    </div>
                </div>
                <label for="conn-player-name" class="help-subtext input-label">Your Name (1-12 chars)</label>
                <input type="text" id="conn-player-name" class="modal-input" placeholder="Your Name" minlength="1" maxlength="12" oninput="validateConnectionInputs()">
                <div class="divider-line"></div>
                <div class="connect-split-row">
                    <div class="connect-col-main">
                        <label for="conn-room-code" class="help-subtext input-label">Room Name (5-20 chars [A-Z & 0-9])</label>
                        <input type="text" id="conn-room-code" class="modal-input room-code-input" placeholder="e.g. EDHNIGHT" minlength="5" maxlength="20" oninput="validateConnectionInputs()" disabled>
                        <button class="control-btn btn-primary" id="btn-join-room" onclick="joinRoom()" disabled>JOIN /
                            CREATE</button>
                    </div>
                    <div class="connect-divider-vertical"></div>
                    <div class="connect-col-side">
                        <button class="control-btn btn-scan-qr" id="btn-scan-qr" onclick="startQRScan()" disabled>
                            <i class="ms ms-beleren ms-2x"></i>SCAN QR
                        </button>
                    </div>
                </div>
                <p id="conn-status" class="help-subtext mt-1">Enter a name to begin.</p>
            </div>
            <div id="connect-step-2" class="hidden text-center" style="display: flex; flex-direction: column; flex-grow: 1;">
                <div class="room-info-split">
                    <div class="room-info-left">
                        <h3 style="margin-top: 0; margin-bottom: 0.5rem;">Room: <span id="display-room-code" class="copyable-code" onclick="copyRoomCode()" title="Tap to copy"></span></h3>
                        <div id="room-qr-display" class="qr-display-box"></div>
                        <p class="help-subtext" style="margin-bottom: 0;">Other players can scan this to join!</p>
                    </div>

                    <div class="room-info-right">
                        <label for="conn-active-name" class="help-subtext input-label" style="text-align: center; margin-top: 0;">Your Display Name</label>
                        <div class="name-edit-row">
                            <input type="text" id="conn-active-name" class="modal-input" placeholder="Your Name" minlength="1" maxlength="12" disabled>
                            <button class="control-btn" id="btn-edit-name" onclick="toggleNameEdit()">
                                <i id="icon-name-edit" class="ss ss-foil ss-grad ss-van"></i>
                            </button>
                        </div>
                        <div class="action-btn-row">
                            <button class="control-btn btn-danger" onclick="leaveRoom()">
                                <i class="ss ss-foil ss-grad ss-bfz"></i>&ensp;DISCONNECT
                            </button>
                            <button class="control-btn" onclick="shareRoomLink()">
                                <i class="ss ss-foil ss-grad ss-plc"></i>&ensp;SHARE LINK
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <button class="close-btn mt-1" onclick="toggleConnectModal()">CLOSE</button>
        </div>
    </div>
    <div id="qr-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content modal-content-fit">
            <h2>Scan QR Code</h2>
            <div id="qr-reader" class="qr-reader-box"></div>
            <button class="close-btn" onclick="stopQRScan()">CANCEL</button>
        </div>
    </div>
    <div id="reset-modal" class="hidden modal-overlay modal-topmost">
        <div class="cmd-modal-content modal-dialog-small">
            <h2 class="dialog-title">Reset Options</h2>
            <div class="dialog-btn-row">
                <button class="close-btn btn-dialog-full btn-primary" onclick="resetMana()">RESET MANA ONLY</button>
                <br>
                <button class="close-btn btn-dialog-full btn-danger" onclick="resetAll()">RESET ALL</button>
                <br>
                <button class="close-btn btn-dialog-full" onclick="closeResetModal()">CANCEL</button>
            </div>
        </div>
    </div>
    <div id="confirm-modal" class="hidden modal-overlay modal-topmost">
        <div class="cmd-modal-content modal-dialog-small">
            <h2 class="dialog-title">CycloneSync</h2>
            <p id="confirm-msg" class="dialog-message">Are you sure?</p>
            <div class="dialog-btn-row">
                <button class="close-btn btn-dialog btn-danger" id="confirm-yes">YES</button>
                <button class="close-btn btn-dialog" id="confirm-no">CANCEL</button>
            </div>
        </div>
    </div>
    <div id="alert-modal" class="hidden modal-overlay modal-topmost">
        <div class="cmd-modal-content modal-dialog-small">
            <h2 class="dialog-title">CycloneSync</h2>
            <p id="alert-msg" class="dialog-message">Notification message.</p>
            <button class="close-btn btn-dialog-full" id="alert-ok">OK</button>
        </div>
    </div>
    <div id="counters-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content">
            <h2>Counters Config</h2>
            <p class="help-subtext mb-0-5">Tap to toggle visibility. Long-press to edit.</p>
            <div class="dock-grid" style="margin-bottom: 0;">
                <input type="checkbox" id="chk-cnt-c1" class="cnt-chk hidden" value="c1">
                <label for="chk-cnt-c1" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c1')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c1" class="ms ms-h ms-2x dock-icon"></i>
                    <span id="modal-label-c1">Poison</span>
                </label>

                <input type="checkbox" id="chk-cnt-c2" class="cnt-chk hidden" value="c2">
                <label for="chk-cnt-c2" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c2')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c2" class="ss ss-c15 ss-2x dock-icon"></i>
                    <span id="modal-label-c2">Experience</span>
                </label>

                <input type="checkbox" id="chk-cnt-c3" class="cnt-chk hidden" value="c3">
                <label for="chk-cnt-c3" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c3')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c3" class="ms ms-energy ms-2x dock-icon"></i>
                    <span id="modal-label-c3">Energy</span>
                </label>

                <input type="checkbox" id="chk-cnt-c4" class="cnt-chk hidden" value="c4">
                <label for="chk-cnt-c4" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c4')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c4" class="ms ms-counter-rad ms-2x dock-icon"></i>
                    <span id="modal-label-c4">Rads</span>
                </label>

                <input type="checkbox" id="chk-cnt-c5" class="cnt-chk hidden" value="c5">
                <label for="chk-cnt-c5" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c5')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c5" class="ms ms-star ms-2x dock-icon"></i>
                    <span id="modal-label-c5">Custom 1</span>
                </label>

                <input type="checkbox" id="chk-cnt-c6" class="cnt-chk hidden" value="c6">
                <label for="chk-cnt-c6" class="dock-chk-label" onclick="handleCounterClick(event)" onpointerdown="startCounterHold(event, 'c6')" onpointerup="stopCounterHold()" onpointercancel="stopCounterHold()" onpointerleave="stopCounterHold()" oncontextmenu="return false;">
                    <i id="modal-icon-c6" class="ms ms-star ms-2x dock-icon"></i>
                    <span id="modal-label-c6">Custom 2</span>
                </label>
            </div>
            <div class="dialog-btn-row mt-auto">
                <button class="close-btn btn-dialog-full btn-primary" onclick="saveCountersConfig()">SAVE & CLOSE</button>
            </div>
        </div>
    </div>
    <div id="dock-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content">
            <h2>Control Dock Config</h2>
            <p class="help-subtext mb-0-5">Pin buttons to the main dock.</p>
            <div class="dock-grid">
                <input type="checkbox" id="chk-dock-life" class="dock-chk hidden" value="btn-life">
                <label for="chk-dock-life" class="dock-chk-label">
                    <i class="ms ss-foil ss-grad ms-ability-lifelink ms-2x dock-icon"></i>
                    <span>Life Tracker</span>
                </label>
                <input type="checkbox" id="chk-dock-tax" class="dock-chk hidden" value="btn-tax">
                <label for="chk-dock-tax" class="dock-chk-label">
                    <i class="ss ss-foil ss-grad ss-cmd ss-2x dock-icon"></i>
                    <span>Commander Tax Tracker</span>
                </label>
                <input type="checkbox" id="chk-dock-pips" class="dock-chk hidden" value="btn-pips">
                <label for="chk-dock-pips" class="dock-chk-label">
                    <i class="ms ss-foil ss-grad ms-watermark-colorpie ms-2x dock-icon"></i>
                    <span>Mana Tracker Tile Control</span>
                </label>
                <input type="checkbox" id="chk-dock-counters" class="dock-chk hidden" value="btn-counters">
                <label for="chk-dock-counters" class="dock-chk-label">
                    <i class="ss ss-foil ss-grad ss-nph ss-2x dock-icon"></i>
                    <span>Other Counters</span>
                </label>
                <input type="checkbox" id="chk-dock-cmd" class="dock-chk hidden" value="btn-cmd">
                <label for="chk-dock-cmd" class="dock-chk-label">
                    <i class="ss ss-foil ss-grad ss-mic ss-2x dock-icon"></i>
                    <span>Commander Damage Tracker</span>
                </label>
                <input type="checkbox" id="chk-dock-connect" class="dock-chk hidden" value="btn-connect">
                <label for="chk-dock-connect" class="dock-chk-label">
                    <i class="ss ss-foil ss-grad ss-eoe ss-2x dock-icon"></i>
                    <span>PodConnect</span>
                </label>
                <input type="checkbox" id="chk-dock-udlr" class="dock-chk hidden" value="btn-udlrswap">
                <label for="chk-dock-udlr" class="dock-chk-label">
                    <i class="ms ss-foil ss-grad ms-dfc-front ms-2x dock-icon"></i>
                    <span>Toggle Tap Zones</span>
                </label>
                <input type="checkbox" id="chk-dock-awake" class="dock-chk hidden" value="btn-awake">
                <label for="chk-dock-awake" class="dock-chk-label">
                    <i class="ms ss-foil ss-grad ms-dfc-day ms-2x dock-icon"></i>
                    <span>Screen WakeLock</span>
                </label>
            </div>
            <div class="dialog-btn-row mt-1">
                <button class="close-btn btn-dialog-full btn-primary" onclick="saveDockConfig()">SAVE</button>
                <button class="close-btn btn-dialog-full" onclick="closeDockModal()">CANCEL</button>
            </div>
        </div>
    </div>
    <div id="help-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content modal-content-help">
            <h2>Help & Info</h2>
            <div class="help-tabs">
                <button class="help-tab-btn active" onclick="switchHelpTab('help-icons')">Icons</button>
                <button class="help-tab-btn" onclick="switchHelpTab('help-basics')">Basics</button>
                <button class="help-tab-btn" onclick="switchHelpTab('help-multi')">PodConnect</button>
            </div>
            <div id="help-icons" class="help-tab-content">
                <div class="help-icon-row">
                    <i class="ms ss-foil ss-grad ms-ability-lifelink ms-2x"></i> <span>toggle life tracker tile</span>
                </div>
                <div class="help-icon-row">
                    <i class="ss ss-foil ss-grad ss-cmd ss-2x"></i> <span>toggle commander tax tracker tile, long press
                        for partners</span>
                </div>
                <div class="help-icon-row">
                    <i class="ms ss-foil ss-grad ms-watermark-colorpie ms-2x"></i> <span>toggle mana tracker
                        tiles</span>
                </div>
                <div class="help-icon-row">
                    <i class="ss ss-foil ss-grad ss-mic ss-2x"></i> <span>toggle commander damage tracker</span>
                </div>
                <div class="help-icon-row">
                    <i class="ss ss-foil ss-grad ss-eoe ss-2x"></i> <span>open PodConnect settings</span>
                </div>
                <div class="help-icon-row">
                    <span class="udlr-wrapper">
                        <i class="ms ss-foil ss-grad ms-dfc-front ms-2x"></i>
                        <span class="udlr-plus ss-foil ss-grad">&plus;</span>
                    </span>
                    <span>swap between up/down and left/right tap zones to change values</span>
                </div>
                <div class="help-icon-row">
                    <i class="ms ss-foil ss-grad ms-dfc-day ms-2x"></i> <span>screen wake lock enabled</span>
                </div>
                <div class="help-icon-row">
                    <i class="ms ms-dfc-night ms-2x"></i> <span>screen wake lock disabled</span>
                </div>
                <div class="help-icon-row">
                    <i class="ms ss-foil ss-grad ms-ability-dfc ms-2x"></i> <span>reset tracking tile values</span>
                </div>
            </div>
            <div id="help-basics" class="help-tab-content hidden">
                <p><strong>Adjusting Values:</strong> Tap the tile to change its value. By default, the top half
                    increases and the bottom half decreases. Use the
                    <span class="udlr-wrapper inline-help-wrapper">
                        <i class="ms ss-foil ss-grad ms-dfc-front"></i>
                        <span class="udlr-plus ss-foil ss-grad">&plus;</span>
                    </span>
                    button to switch to left/right tap zones!
                </p>
                <p><strong>Mana Tiles:</strong> Tap the <i class="ms ss-foil ss-grad ms-watermark-colorpie ms-2x"></i>
                    button to show or hide mana tracker tiles. <em>Long-press</em> the button to choose which specific
                    tiles are always shown and which are toggled by the button.</p>
                <p><strong>Custom Names:</strong> You can tap on any name in the commander damage tracker window to edit
                    them.</p>
            </div>
            <div id="help-multi" class="help-tab-content hidden">
                <p><strong>Your Name:</strong> You must enter a name to join a room (1 - 12 characters).</p>
                <p><strong>Join or Create a Room:</strong> Enter a 5+ character room name to create a new room or join
                    an existing room. You can use the <em>SCAN QR</em> button to quickly join an existing room (check
                    with another player and they can display their room's QR).</p>
                <p><strong>Life Total Syncing:</strong> A "room bar" will appear and show you the life total of the
                    <strong>other</strong> players in the room and will remain synced as long as they're in the room.
                    When you change your life total using your life tracker tile that value will sync and update on the
                    other players' screens.
                </p>
                <p><strong>Idle Timeout:</strong> The app will automatically disconnect you if it's in the background,
                    if the device is locked, or if you're idle for 30 or more minutes.</p>
            </div>
            <button class="close-btn mt-auto" onclick="toggleHelp()">CLOSE</button>
        </div>
    </div>
    <div id="share-modal" class="hidden modal-overlay">
        <div class="cmd-modal-content modal-content-fit">
            <h2>Share</h2>
            <div id="share-qr-display" class="qr-display-box"></div>
            <p>
                <a href="https://regularwave.github.io/cyclonesync/" target="_blank">https://regularwave.github.io/cyclonesync/</a>
            </p>
            <button id="btn-native-share" class="control-btn hidden mt-1" onclick="shareNatively()" style="width: 100%;">
                <i class="ss ss-foil ss-grad ss-plc"></i> SHARE APP
            </button>
            <button class="close-btn" onclick="toggleShare()">CLOSE</button>
        </div>
    </div>
    <div id="counter-edit-modal" class="hidden modal-overlay modal-topmost">
        <div class="cmd-modal-content">
            <h2>Edit Counter</h2>
            <div class="custom-counter-row" style="margin-bottom: 1rem;">
                <input type="text" id="edit-counter-name" class="modal-input custom-name-input" placeholder="Name" maxlength="12">
                <input type="color" id="edit-counter-color" class="color-picker-input">
                <div class="custom-icon-btn" style="pointer-events:none; display:flex; align-items:center; justify-content:center;">
                    <i id="edit-counter-icon-preview" class="ms ms-acorn ms-2x"></i>
                </div>
            </div>
            <div id="icon-picker-grid" class="icon-picker-grid"></div>
            <div class="dialog-btn-row mt-auto">
                <button class="close-btn btn-dialog-full btn-primary" onclick="saveCounterEdit()">SAVE</button>
                <button class="close-btn btn-dialog-full" onclick="closeCounterEdit()">CANCEL</button>
            </div>
        </div>
    </div>
    <footer id="sticky-footer">
        <span class="footer-link" onclick="toggleHelp()">
            <i class="ss ss-foil ss-grad ss-mb2"></i> <span class="footer-text">Help</span>
        </span>
        <span class="footer-separator">|</span>
        <span class="footer-link" onclick="toggleCredits()">
            <i class="ms ss-foil ss-grad ms-artist-nib"></i> <span class="footer-text">Credits</span>
        </span>
        <span class="footer-separator">|</span>
        <a href="https://github.com/regularwave/cyclonesync" target="_blank" class="footer-link">
            <i class="ss ss-foil ss-grad ss-emn"></i> <span class="footer-text">GitHub</span>
        </a>
        <span class="footer-separator">|</span>
        <span class="footer-link" onclick="toggleShare()">
            <i class="ss ss-foil ss-grad ss-plc"></i> <span class="footer-text">Share</span>
        </span>
    </footer>
    <div id="update-toast" class="update-toast hidden">
        <span>Update found!</span>
        <div class="update-toast-btns">
            <button id="btn-update-refresh" class="btn-update-yes">UPDATE</button>
            <button id="btn-update-dismiss" class="btn-update-no">IGNORE</button>
        </div>
    </div>
    <script type="module" src="script.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            let refreshing = false;
            let newWorker;

            let isInitialInstall = !navigator.serviceWorker.controller;

            navigator.serviceWorker.addEventListener('controllerchange', () => {
                if (isInitialInstall) {
                    isInitialInstall = false;
                    return;
                }

                if (!refreshing) {
                    refreshing = true;
                    window.location.reload();
                }
            });
            const toast = document.getElementById('update-toast');
            const btnUpdate = document.getElementById('btn-update-refresh');
            const btnDismiss = document.getElementById('btn-update-dismiss');
            if (btnUpdate) {
                btnUpdate.onclick = () => {
                    if (toast) toast.classList.add('hidden');
                    if (newWorker) newWorker.postMessage('SKIP_WAITING');
                };
            }
            if (btnDismiss) {
                btnDismiss.onclick = () => {
                    if (toast) toast.classList.add('hidden');
                };
            }
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js').then(reg => {
                    console.log('SW Registered');
                    if (reg.waiting) {
                        newWorker = reg.waiting;
                        showUpdatePrompt();
                    }
                    reg.addEventListener('updatefound', () => {
                        newWorker = reg.installing;
                        newWorker.addEventListener('statechange', () => {
                            if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                showUpdatePrompt();
                            }
                        });
                    });
                }).catch(err => console.log('SW Registration Failed: ', err));
            });
            function showUpdatePrompt() {
                if (!toast) return;
                toast.classList.remove('hidden');
            }
        }
    </script>
</body>

</html>